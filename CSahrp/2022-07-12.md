## Memory

<br>

|Stack|Heap|Data|Code|
|------|---|---|---|
|지역 변수, 매개변수 저장, 컴파일 시점에 크기 할당을 사용|사용자 관리 영역, 사용자 정의에 의해 할당된 메모리에 저장하거나 해제하는 동적 하당을 사용| 전역 변수, static 변수, 프로그램이 종료 될때까지 지워지지 않고 컴파일 시점에 크기 할당|소스코드, 기계어로 제어되는 메모리 영역|

<br>

### Stack overflow

<br>

- 할당된 스택 내에 stack frame이 쌓이게 되는데, 과도한 재귀 또는 너무 큰 지역 변수를 선언하게 되면 stack 역의 크기를 초과하게 되면서 다른 메모리 영역을 침범하는 현상
- Stackframe - 함수의 매개변수, 반환 주소 값

Heap overflow

- 사용자가 지정해준 메모리 크기가 넘어설 경우 gc가 알아서 메모리 관리를 해주지만 너무 큰 초과일경우 발생 가능함

<br>

### 메모리 최적화 방법

<br>

1. String 사용할때 + 연산자는 되도록 사용 금지

    - String 자체가 불변 객체이기 때문에 + 연산자를 하면 내부적으로 새로운 객체가 생성되고 기존 객체는 참조 없이 쌓이기만 함으로 변화가 자주 일어나는 경우 String 대신 StringBuilder 를 생각하자<br>

2. 웬만하면 박식/언박싱이 일어나지 않도록 해야함

    - 값 타입에서 참조타입으로, 참조 타입에서 값 타입으로 변환하는 작업은 굉장히 느리고   좋지 못함

    - 값 타입이 참조 타입으로 변환될때 힙 메모리에 쌓이고 복사된다

3. 자원을 다룰때 using 키워드 이용

    - Using 키워드를 이요앟면 괄호를 빠져나올때 자동으로 Dispose를 해준다. 파일 폰트 등등

4. C#에서  System.Collections.Genric.List 를 쓸 필요 없는때에는 쓰지 말것

5. 단일 원칙 지킬것

6. 객체지향 언어에서는 단일 책임 구조로 해여한다

7. String 대소문자 구분 없이 비교할 때 Compare 함수를 사용해라

8. ToUpper(), ToLower()를 사용하면 내부적으로 불필요한 객체 2개를 만들게 되면 이는 <b>GC</b>의 대상이 된다.


### Gc란 ?

<br>

 GC (Garbage Collection)
 - 메모리 관리 기법 중의 하나로, 프로그램이 동적으로 할당햇던 메모리 영역 중에서 필요없게된 영역을 해제하는 기능이다.

|장점|단점|
|--|--|
|유효하지 안은 포인터 접근(이미 해제된 메모리에 접근하는 버그)<br>이중 해제(이미 해제된 메모리를 또 다시 해제하는 버그)<br>메모리 누수 등등|할당된 메모리 해제 되는 시점 알수없음<br>GC가 일어하는 시점 파악 힘듬|

<br>


